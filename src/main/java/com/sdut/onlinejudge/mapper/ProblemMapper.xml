<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sdut.onlinejudge.mapper.ProblemMapper">


    <select id="fetchSingleSelects" parameterType="int" resultType="singleSelect">
        SELECT * FROM single_selects WHERE
        spid >= (SELECT floor(RAND() * (SELECT MAX(spid) FROM single_selects)))
        ORDER BY spid LIMIT 0, #{count}
    </select>

    <select id="fetchMultiSelects" parameterType="int" resultType="multiSelect">
        SELECT * FROM multi_selects WHERE
        mpid >= (SELECT floor(RAND() * (SELECT MAX(mpid) FROM multi_selects)))
        ORDER BY mpid LIMIT 0, #{count}
    </select>

    <select id="fetchJudgeProblem" parameterType="int" resultType="judgeProblem">
        SELECT * FROM judge_problems WHERE
        jpid >= (SELECT floor(RAND() * (SELECT MAX(jpid) FROM judge_problems)))
        ORDER BY jpid LIMIT 0, #{count}
    </select>

    <select id="getSingleSelects" parameterType="string" resultType="singleSelect">
        select * from single_selects
        <where>
            <if test="keyWords != null">
                <bind name="keywords" value="'%' + keyWords + '%'"/>
                and hint like #{keywords}
            </if>
        </where>
    </select>

    <select id="getMultiSelects" parameterType="string" resultType="multiSelect">
        select * from multi_selects
        <where>
            <if test="keyWords != null">
                <bind name="keywords" value="'%' + keyWords + '%'"/>
                and hint like #{keywords}
            </if>
        </where>
    </select>

    <select id="getJudgeProblem" parameterType="string" resultType="judgeProblem">
        select * from judge_problems
        <where>
            <if test="keyWords != null">
                <bind name="keywords" value="'%' + keyWords + '%'"/>
                and hint like #{keywords}
            </if>
        </where>
    </select>

    <insert id="addJudgeProblem" parameterType="judgeProblem">
        insert into judge_problems(title, optionT, optionF, answer, hint)
        values (#{title}, "正确", "错误", #{answer}, #{hint})
    </insert>

    <insert id="addSingleSelect" parameterType="singleSelect">
        insert into single_selects(title, optionA, optionB, optionC, optionD, optionE, answer, hint)
        values (#{title}, #{optionA}, #{optionB}, #{optionC}, #{optionD}, #{optionE}, #{answer}, #{hint})
    </insert>

    <insert id="addMultiSelect" parameterType="multiSelect">
        insert into multi_selects(title, optionA, optionB, optionC, optionD, optionE, answer, hint)
        values (#{title}, #{optionA}, #{optionB}, #{optionC}, #{optionD}, #{optionE}, #{answer}, #{hint})
    </insert>

    <delete id="delJudgeProblem" parameterType="string">
        delete from judge_problems where jpid=#{jpid}
    </delete>

    <delete id="delSingleSelect" parameterType="string">
        delete from single_selects where spid=#{spid}
    </delete>

    <delete id="delMultiSelect" parameterType="string">
        delete from multi_selects where mpid=#{mpid}
    </delete>


</mapper>
